<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>pika - Evaluate Correlation Between Time Series • pika</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="pika - Evaluate Correlation Between Time Series">
<meta name="description" content="A lightweight R package for evaluating correlation between time series, developed for epidemiological applications at the MRC Centre for Global Infectious Disease Analysis.
">
<meta property="og:description" content="A lightweight R package for evaluating correlation between time series, developed for epidemiological applications at the MRC Centre for Global Infectious Disease Analysis.
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">pika</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/pika_vignette.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/pika_vignette.html">pika: Evaluating Correlation Between Time Series</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mrc-ide/pika/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="pika-">pika <img src="inst/pika_hex.png" align="right" height="139"><a class="anchor" aria-label="anchor" href="#pika-"></a>
</h1></div>
<!-- badges: start -->

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><strong>pika</strong> is a lightweight R package for evaluating correlation between time series. It was developed at the MRC Centre for Global Infectious Disease Analysis for epidemiological applications, particularly for studying relationships between reproduction numbers (Rt) and population mobility during infectious disease outbreaks.</p>
<p>This package was developed as part of the research described in:</p>
<blockquote>
<p>Ainslie KEC, Walters CE, Fu H, et al. Evidence of initial success for China exiting COVID-19 social distancing policy after achieving containment. <em>Wellcome Open Research</em>. 2020;5:81. doi: <a href="https://doi.org/10.12688/wellcomeopenres.15843.2" class="external-link">10.12688/wellcomeopenres.15843.2</a></p>
</blockquote>
<div class="section level3">
<h3 id="key-features">Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h3>
<ul>
<li>
<strong>Cross-correlation analysis</strong>: Determine the optimal lag between two time series where correlation is highest</li>
<li>
<strong>Rolling correlation</strong>: Calculate time-varying correlation between paired time series</li>
<li>
<strong>Reproduction number estimation</strong>: Wrapper around EpiEstim for group-wise Rt estimation</li>
<li>
<strong>Percent change calculation</strong>: Convert count variables to percent change relative to a baseline period</li>
<li>
<strong>Visualization tools</strong>: Plot time series with correlation overlays and lag distributions</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of pika from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"mrc-ide/pika"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="integration-with-orderly">Integration with orderly<a class="anchor" aria-label="anchor" href="#integration-with-orderly"></a>
</h3>
<p>To use <code>pika</code> within an <code>orderly</code> task, install from the drat repository:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">drat</span><span class="fu">:::</span><span class="fu">add</span><span class="op">(</span><span class="st">"ncov-ic"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"pika"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mrc-ide.github.io/pika/">pika</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load example data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">china_case_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">exante_movement_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimate reproduction number by province</span></span>
<span><span class="va">rt_estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/estimate_rt.html">estimate_rt</a></span><span class="op">(</span></span>
<span>  dat <span class="op">=</span> <span class="va">china_case_data</span>,</span>
<span>  grp_var <span class="op">=</span> <span class="st">"province"</span>,</span>
<span>  date_var <span class="op">=</span> <span class="st">"date"</span>,</span>
<span>  incidence_var <span class="op">=</span> <span class="st">"cases"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Join Rt estimates with mobility data</span></span>
<span><span class="va">data_joined</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span></span>
<span>  <span class="va">rt_estimates</span>,</span>
<span>  <span class="va">exante_movement_data</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"date_end"</span> <span class="op">=</span> <span class="st">"date"</span>, <span class="st">"province"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Determine optimal lag between Rt and movement</span></span>
<span><span class="va">lags</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cross_corr.html">cross_corr</a></span><span class="op">(</span></span>
<span>  dat <span class="op">=</span> <span class="va">data_joined</span>,</span>
<span>  date_var <span class="op">=</span> <span class="st">"date_end"</span>,</span>
<span>  grp_var <span class="op">=</span> <span class="st">"province"</span>,</span>
<span>  x_var <span class="op">=</span> <span class="st">"r_mean"</span>,</span>
<span>  y_var <span class="op">=</span> <span class="st">"movement"</span>,</span>
<span>  max_lag <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate rolling correlation</span></span>
<span><span class="va">data_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rolling_corr.html">rolling_corr</a></span><span class="op">(</span></span>
<span>  dat <span class="op">=</span> <span class="va">data_joined</span>,</span>
<span>  date_var <span class="op">=</span> <span class="st">"date_end"</span>,</span>
<span>  grp_var <span class="op">=</span> <span class="st">"province"</span>,</span>
<span>  x_var <span class="op">=</span> <span class="st">"r_mean"</span>,</span>
<span>  y_var <span class="op">=</span> <span class="st">"movement"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">14</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize results</span></span>
<span><span class="fu"><a href="reference/plot_corr.html">plot_corr</a></span><span class="op">(</span></span>
<span>  dat <span class="op">=</span> <span class="va">data_corr</span>,</span>
<span>  date_var <span class="op">=</span> <span class="st">"date_end"</span>,</span>
<span>  grp_var <span class="op">=</span> <span class="st">"province"</span>,</span>
<span>  x_var <span class="op">=</span> <span class="st">"r_mean"</span>,</span>
<span>  y_var <span class="op">=</span> <span class="st">"movement"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h2>
<table class="table">
<colgroup>
<col width="43%">
<col width="56%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="reference/cross_corr.html">cross_corr()</a></code></td>
<td>Determine the lag at which cross-correlation is highest between two time series</td>
</tr>
<tr class="even">
<td><code><a href="reference/rolling_corr.html">rolling_corr()</a></code></td>
<td>Calculate rolling (moving) correlation between two time series</td>
</tr>
<tr class="odd">
<td><code><a href="reference/estimate_rt.html">estimate_rt()</a></code></td>
<td>Estimate effective reproduction number (Rt) by group using EpiEstim</td>
</tr>
<tr class="even">
<td><code><a href="reference/calc_percent_change.html">calc_percent_change()</a></code></td>
<td>Convert counts to percent change relative to a baseline period</td>
</tr>
<tr class="odd">
<td><code><a href="reference/plot_corr.html">plot_corr()</a></code></td>
<td>Visualize time series and rolling correlation</td>
</tr>
<tr class="even">
<td><code><a href="reference/plot_lag.html">plot_lag()</a></code></td>
<td>Plot histogram of lags by group</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="included-data">Included Data<a class="anchor" aria-label="anchor" href="#included-data"></a>
</h2>
<p>pika includes example datasets from the COVID-19 pandemic in China:</p>
<ul>
<li>
<strong>china_case_data</strong>: Daily confirmed COVID-19 cases by province (Jan 16 - Mar 24, 2020)</li>
<li>
<strong>exante_movement_data</strong>: Daily within-city movement index by province (Jan 1 - Mar 24, 2020)</li>
</ul>
</div>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h2>
<p>For detailed usage examples and methodology, see the package vignette:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"pika_vignette"</span>, package <span class="op">=</span> <span class="st">"pika"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use pika in your research, please cite:</p>
<blockquote>
<p>Ainslie KEC, Walters CE, Fu H, et al. Evidence of initial success for China exiting COVID-19 social distancing policy after achieving containment. <em>Wellcome Open Research</em>. 2020;5:81. doi: <a href="https://doi.org/10.12688/wellcomeopenres.15843.2" class="external-link">10.12688/wellcomeopenres.15843.2</a></p>
</blockquote>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>MIT License. See <a href="LICENSE.html">LICENSE</a> for details.</p>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>Contributions are welcome! Please feel free to submit issues or pull requests on <a href="https://github.com/mrc-ide/pika" class="external-link">GitHub</a>.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/mrc-ide/pika/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/mrc-ide/pika/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing pika</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://orcid.org/0000-0001-5419-7206" class="external-link">Kylie Ainslie</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/https://orcid.org/0000-0001-5419-7206" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/mrc-ide/pika/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/mrc-ide/pika/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/mrc-ide/pika?branch=master" class="external-link"><img src="https://codecov.io/gh/mrc-ide/pika/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://orcid.org/0000-0001-5419-7206" class="external-link">Kylie Ainslie</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
